!function(){"use strict";class e{constructor(e){this.todo=document.querySelector(".todo-in"),this.progress=document.querySelector(".progress-in"),this.done=document.querySelector(".done-in"),this.addCardBtn=document.querySelectorAll(".add-card"),this.card=document.querySelector(".card-block"),this.textArea=document.querySelector(".card-text"),this.text=null,this.storage=e}events(){this.renderDom(),this.addAnotherCard(),this.moveMouseRemoveDiv()}renderDom(){const t=this.storage.load();t&&(t.todo&&t.todo.forEach((t=>{e.createNewDiv(this.todo,t)})),t.progress&&t.progress.forEach((t=>{e.createNewDiv(this.progress,t)})),t.done&&t.done.forEach((t=>{e.createNewDiv(this.done,t)})))}addAnotherCard(){for(const t of this.addCardBtn)t.addEventListener("click",(s=>{s.preventDefault();const o=this.card.cloneNode(!0);o.classList.remove("none"),t.closest("div").appendChild(o),t.classList.add("none"),this.inputText(o.children[0]),this.addCardInDiv(o.children[1].children[0],t.closest("div").children[1],t,o),e.cancelAddCardInDiv(o.children[1].children[1],t,o)}))}static createNewDiv(e,t){if(null===t)return;const s=document.createElement("div");s.textContent=t,s.classList.add("new-div"),e.appendChild(s);const o=document.createElement("span");o.classList.add("new-div-remove"),o.classList.add("none"),o.textContent="Ã—",s.appendChild(o)}inputText(e){e.addEventListener("input",(e=>{this.text=e.target.value}))}addCardInDiv(t,s,o,n){t.addEventListener("click",(()=>{e.createNewDiv(s,this.text),n.remove(),o.classList.remove("none"),this.saveCards(s,this.text),this.moveMouseRemoveDiv()}))}static cancelAddCardInDiv(e,t,s){e.addEventListener("click",(()=>{s.remove(),t.classList.remove("none")}))}moveMouseRemoveDiv(){const e=document.querySelectorAll(".new-div");for(const t of e)t.addEventListener("mouseover",(()=>{t.children[0].classList.contains("none")&&t.children[0].classList.remove("none")})),t.addEventListener("mouseout",(()=>{t.children[0].classList.contains("none")||t.children[0].classList.add("none")}));for(const t of e)t.children[0].addEventListener("click",(()=>{t.remove(),this.storage.updateCards(this.todo,this.progress,this.done)}))}saveCards(e,t){e.contains(this.todo)?this.storage.save({todo:t}):e.contains(this.progress)?this.storage.save({progress:t}):e.contains(this.done)&&this.storage.save({done:t}),null!==this.text&&(this.text=null)}}const t=new class{constructor(){this.storage=localStorage}save(e){let t=JSON.parse(this.storage.getItem("card"));null===t&&(t={todo:[],progress:[],done:[]}),e.todo?t.todo.push(e.todo):e.progress?t.progress.push(e.progress):e.done&&t.done.push(e.done),this.storage.setItem("card",JSON.stringify(t))}load(){try{return JSON.parse(this.storage.getItem("card"))}catch(e){throw new Error(e)}}clear(){this.storage.removeItem("card")}updateCards(e,t,s){this.clear();for(const t of e.children){const e=t.textContent;this.save({todo:e.slice(0,e.length-1)})}for(const e of t.children){const t=e.textContent;this.save({progress:t.slice(0,t.length-1)})}for(const e of s.children){const t=e.textContent;this.save({done:t.slice(0,t.length-1)})}}},s=new e(t),o=new class{constructor(e){this.container=document.querySelector("#container"),this.todo=document.querySelector(".todo-in"),this.progress=document.querySelector(".progress-in"),this.dndIn=document.querySelectorAll(".dnd-in"),this.done=document.querySelector(".done-in"),this.cloneEl=null,this.draggedEl=null,this.storage=e,this.grabX=null,this.grabY=null,this.osX=null,this.osY=null}events(){this.dragMouseDown(this.dndIn),this.dragMouseMove(this.container),this.dragMouseLeave(this.container),this.dropElement(this.container)}dragMouseDown(e){for(const t of e)t.addEventListener("mousedown",(e=>{e.preventDefault(),e.target.classList.contains("new-div")&&(this.draggedEl=e.target,this.cloneEl=e.target.cloneNode(!0),this.cloneEl.classList.add("dragged"),this.draggedEl.classList.add("opacity"),document.body.appendChild(this.cloneEl),document.body.style.cursor="grabbing",this.grabX=e.pageX,this.grabY=e.pageY,this.osX=this.draggedEl.offsetLeft,this.osY=this.draggedEl.offsetTop,this.cloneEl.style.left=`${this.draggedEl.offsetLeft}px`,this.cloneEl.style.top=`${this.draggedEl.offsetTop}px`)}))}dragMouseMove(e){e.addEventListener("mousemove",(e=>{if(e.preventDefault(),!this.draggedEl)return;const t=document.elementFromPoint(e.clientX,e.clientY);t.parentElement.classList.contains("dnd-in")&&(this.draggedEl.classList.add("opacity"),e.clientY-(t.offsetTop+t.offsetHeight/2)<0?t.parentElement.insertBefore(this.draggedEl,t):t.parentElement.insertBefore(this.draggedEl,t.nextSibling)),this.cloneEl.style.left=e.pageX-(this.grabX-this.osX)+"px",this.cloneEl.style.top=e.pageY-(this.grabY-this.osY)+"px"}))}dragMouseLeave(e){e.addEventListener("mouseleave",(()=>{this.draggedEl&&(this.draggedEl.classList.remove("opacity"),document.body.removeChild(this.cloneEl),this.cloneEl=null,this.draggedEl=null)}))}dropElement(e){e.addEventListener("mouseup",(e=>{if(!this.draggedEl)return;const t=document.elementFromPoint(e.clientX,e.clientY);t.parentElement.classList.contains("dnd-in")?t.parentElement.insertBefore(this.draggedEl,t):t.classList.contains("dnd-in")&&t.appendChild(this.draggedEl),document.body.removeChild(this.cloneEl),document.body.style="",this.draggedEl.classList.remove("opacity"),this.cloneEl=null,this.draggedEl=null,this.storage.updateCards(this.todo,this.progress,this.done)}))}}(t);s.events(),o.events()}();
//# sourceMappingURL=main.js.map